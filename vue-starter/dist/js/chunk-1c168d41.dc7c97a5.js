(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c168d41"],{"7f7f":function(t,e,a){var n=a("86cc").f,o=Function.prototype,i=/^\s*function ([^ (]*)/,s="name";s in o||a("9e1e")&&n(o,s,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},cb50:function(t,e,a){"use strict";var n=a("e029"),o=a.n(n);o.a},e029:function(t,e,a){},e842:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),t._v(" "),a("b-form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("b-card",{attrs:{"no-body":""}},[a("b-card-body",{staticClass:"pb-2"},[a("b-form-group",{attrs:{label:"标题"}},[a("b-input",{attrs:{required:""},model:{value:t.infoData.title,callback:function(e){t.$set(t.infoData,"title",e)},expression:"infoData.title"}})],1),t._v(" "),a("b-form-group",{attrs:{label:"类别"}},[a("b-select",{staticClass:"flex-grow-1 col-3",attrs:{options:t.category},model:{value:t.infoData.category,callback:function(e){t.$set(t.infoData,"category",e)},expression:"infoData.category"}})],1),t._v(" "),a("b-form-group",{attrs:{label:"内容"}},[a("b-textarea",{attrs:{rows:3,required:""},model:{value:t.infoData.content,callback:function(e){t.$set(t.infoData,"content",e)},expression:"infoData.content"}})],1),t._v(" "),a("b-form-group",{attrs:{label:"标的"}},[a("b-textarea",{attrs:{rows:3,required:""},model:{value:t.infoData.targets,callback:function(e){t.$set(t.infoData,"targets",e)},expression:"infoData.targets"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"text-right mt-3"},[a("b-btn",{attrs:{type:"submit",variant:"primary"}},[t._v("提交")]),t._v(" \n      ")],1)],1)],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h4",{staticClass:"font-weight-bold py-3 mb-4"},[t._v("\n    编辑资讯\n    "),a("span",{staticClass:"text-muted"})])}],i=(a("7f7f"),a("1c46"),{name:"pages-infos-edit",metaInfo:{title:"编辑资讯"},components:{},data:function(){return{user_id:sessionStorage.user_id||localStorage.user_id,token:sessionStorage.token||localStorage.token,username:"",nickname:"",is_employee:"",info_id:"",infoData:{},cats:[],category:{8:"default"}}},created:function(){this.getId(),this.checkLogin()},beforeDestroy:function(){},destroyed:function(){},mounted:function(){this.getInfoCats(),this.renderInfos()},methods:{getInfoCats:function(){var t=this,e=this.$host+"/info-cats/";this.$ajax.get(e).then(function(e){console.log(e.data),t.cats=e.data;for(var a=0;a<e.data.length;a++)t.category[e.data[a].id]=e.data[a].name})},checkLogin:function(){var t=this;if(this.user_id&&this.token){var e=this.$host+"/user-profile/";this.$ajax.get(e,{headers:{Authorization:"JWT "+this.token},responseType:"json"}).then(function(e){t.user_id=e.data.id,t.username=e.data.username,t.nickname=e.data.nickname,t.is_employee=e.data.is_employee}).catch(function(t){401!=t.response.status&&403!=t.response.status||(location.href="/authentication/login")})}else location.href="/authentication/login"},getId:function(){this.info_id=this.$route.params.id},renderInfos:function(){var t=this,e=this.$host+"/infos-detail/"+this.info_id+"/";this.$ajax.get(e).then(function(e){console.log(e.data),t.infoData=e.data})},onSubmit:function(){var t=this.$host+"/infos-detail/"+this.info_id+"/editors/";this.username;this.$ajax.put(t,{info_id:this.info_id,title:this.infoData.title,content:this.infoData.content,targets:this.infoData.targets,category:this.infoData.category},{responseType:"json"}).then(function(t){alert("编辑成功"),window.location.reload()}).catch(function(t){400==t.response.status?console.log(t.response.data):console.log(t.response.status)})}}}),s=i,r=(a("60bc"),a("d152"),a("59ec"),a("1c91"),a("cb50"),a("2877")),c=Object(r["a"])(s,n,o,!1,null,null,null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-1c168d41.dc7c97a5.js.map